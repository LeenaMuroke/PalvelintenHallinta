# Raportti h3 Git

Nämä tehtävät ovat kolmannen viikon tehtäviä Haaga-Helia ammattikorkeakoulun kurssilla "Palvelinten hallinta". Tehtävänannot löytyvät osoitteesta: [https://terokarvinen.com/2022/palvelinten-hallinta-2022p2/#h1-hello-salt](https://terokarvinen.com/2022/palvelinten-hallinta-2022p2/?fromSearch=configuration%20management#h3-git)

Tehtävät on suoritettu XXXX välisenä aikana. Alla ympäristön listaus:

Pääkone:

Kannettava tietokone: Lenovo IdeaPad 5 Pro
Käyttöjärjestelmä: Microsoft Windows 11 Home
Prosessori: AMD Ryzen 7 5800U with Radeon Graphics
RAM: 16 GB
Tähän asennettu virtuaalikone

Virtuaalikone:

Oracle VirtualBox 6.1.40
Käyttöjärjestelmä: Debian 11 64-bit
RAM: 4GB
Levytila: 60GB

## a) MarkDown. Tee tämän tehtävän raportti MarkDownina. Helpointa on tehdä raportti GitHub-varastoon, jolloin md-päätteiset tiedostot muotoillaan automaattisesti. Tyhjä rivi tekee kappalejaon, risuaita ‘#’ tekee otsikon, sisennys merkitsee koodinpätkän. (Karvinen, 2022.)

Tämä koko raportti on kirjoitettu MakDownin avulla GitHubissa. Samoiten tämän kussin edelliset raportit ovat kirjoitettu MarkDownilla, ja löytyvät tästä samasta PalvelintenHallinta varastosta.

## b) Offline. Tee paikallinen offline-varasto git:llä. Varaston nimessä tulee olla sana "cat" (kissa). Aiemmin tehty varasto ei siis kelpaa. Aseta itsellesi sähköpostiosoite ja nimi. Näytä varastollasi muutosten teko ja niiden katsominen lokista. (Karvinen, 2022.)

Aloitin tehtävän päivittämällä paketit `sudo apt-get update`. Git oli jo asennettuna tunnilla komennolla `sudo apt-get install git`. Loin offline-varaston virtuaalikoneelleni `git init cat`. "Cat" on varaston nimi tehtävänannon mukaisesti. 

     leenam@linuxkurssi:~$ git init cat
     hint: Using 'master' as the name for the initial branch. This default branch name
     hint: is subject to change. To configure the initial branch name to use in all
     hint: of your new repositories, which will suppress this warning, call:
     hint: 
     hint: 	git config --global init.defaultBranch <name>
     hint: 
     hint: Names commonly chosen instead of 'master' are 'main', 'trunk' and
     hint: 'development'. The just-created branch can be renamed via this command:
     hint: 
     hint: 	git branch -m <name>
     Initialized empty Git repository in /home/leenam/cat/.git/

Menin varastoon `cd cat` ja loin tiedoston `micro testicat.md`, johon kirjoitin tekstiä. Tallensin tämän version Gittiin komenolla `git add .` ja `git commit`. 

     leenam@linuxkurssi:~$ cd cat/
     leenam@linuxkurssi:~/cat$ micro testicat.md
     leenam@linuxkurssi:~/cat$ ls
     testicat.md
     leenam@linuxkurssi:~/cat$ git add .
     leenam@linuxkurssi:~/cat$ git commit
     [master (root-commit) 1d69885] Add purpose to testicat.rm
     1 file changed, 3 insertions(+)
      create mode 100644 testicat.md

Selitteeksi tähän versioon kirjasin "Add purpose to testicat.md", eli muokattu kyseistä testicat tiedostoa. 

<img width="371" alt="image" src="https://user-images.githubusercontent.com/111494018/201634678-f84e3df2-5574-483b-97f2-d97edab2252f.png">

Tarkistin lokeista mitä olen tehnyt. Ensiksi tarkistin komennolla `git log`, mitä edellisessä versiontallennuksessa olen tehnyt. Sen jälkeen katsoin myös `git log --patch`, joka tarkentaa mitkä rivit ovat tässä versisossa muokattu.

    leenam@linuxkurssi:~/cat$ git log
    commit 1d698853816a226bf886f40e76217daeaf27609e (HEAD -> master)
    Author: Leena Muroke <muroke.leena@gmail.com>
    Date:   Mon Nov 14 12:15:13 2022 +0200

        Add purpose to testicat.rm
    leenam@linuxkurssi:~/cat$ git log --patch
    commit 1d698853816a226bf886f40e76217daeaf27609e (HEAD -> master)
    Author: Leena Muroke <muroke.leena@gmail.com>
    Date:   Mon Nov 14 12:15:13 2022 +0200

        Add purpose to testicat.rm

    diff --git a/testicat.md b/testicat.md
    new file mode 100644
    index 0000000..87158ca
    --- /dev/null
    +++ b/testicat.md
    @@ -0,0 +1,3 @@
    +Tämä on harjoitus
    +Cat 
    +Moikkamoi

Eli ensimmäinen loki kertoo selitetekstin minkä kirjoitin, eli tiedostoa on muokattu. Toinen testi spesifioi trkemmin, että tiedostoon on lisätty rivit "Tämä on harjoitus", "Cat" ja "Moikkamoi". 

Samalla huomasin, että sähköpostini ja nimeni ovat jo oikein. Kävin kuitenkin harjoituksen vuoksi niitä mukamas vaihtamassa komennoilla `git config --global user.name "Leena Muroke"` ja `git config --global user.email "muroke.leena@gmail.com"`. Eli määräsin nimekseni oman nimeni Leena Muroke ja sähköpostiosoitteekseni osoitteeni muroke.leena@gmail.com. Näistä ei tullut mitään ilmoitusta, että mikään olisi muuttunut. 

    leenam@linuxkurssi:~/cat$ git config --global user.name "Leena Muroke"
    leenam@linuxkurssi:~/cat$ git config --global user.email "muroke.leena@gmail.com"

## c) Doh! Tee tyhmä muutos gittiin, älä tee commit:tia. Tuhoa huonot muutokset ‘git reset --hard’. Huomaa, että tässä toiminnossa ei ole peruutusnappia. (Karvinen, 2022.)

Jatkoin tämän tehtävän edellisen tehtävän päälle, eli käytän edellisessä tehtävässä luomaani Cat-varastoa. Menin varastoon ja lähdin muokkaamaan testicat.md tiedostoa komennolla `micro testicat.md`. Lisäsin sinne tekstiä "EN EN HALUA TALLENTAA TÄTÄ RIVIÄ", jota en halua tallentaa Gittiin. 

<img width="188" alt="image" src="https://user-images.githubusercontent.com/111494018/201638737-18ca14a2-fd95-4fd5-8c8f-785dfb4a2aa4.png">

Normaalisti tässä kohti tallentaisin TOIMIVAN version `git add .` ja `git commit`. Mutta koska tiedän tämän olevan eihaluttu versio, ei sitä tule tallentaa. Gittiin tallentaan vain TOIMIVIA versioita! Joten tuhosin tähän versioon tekemäni muutokset komennolla `git reset --hard`. Tästä tuli ilmoitus, että uusi otsikko on "Add purpose to testicat.md", mikä on edellisessä tehtävässä luomani edellinen versio. Eli tämä juuri luomani versio on tuhottu, ja palattu edelliseen tallennettuun versioon. 

    leenam@linuxkurssi:~/cat$ micro testicat.md 
    leenam@linuxkurssi:~/cat$ git reset --hard
    HEAD is now at 1d69885 Add purpose to testicat.rm
    leenam@linuxkurssi:~/cat$ micro testicat.md 

Kävin tarkistamassa testcat.md tiedoston micro-editorilla ja sieltä todentotta oli lähtenyt haluamani lisätty rivi pois. Ja jäljelle jäänyt kolme ensimmäistä riviä aiemmasta versiosta. Eli palattu aiempaan tallennettuun versioon.

<img width="180" alt="image" src="https://user-images.githubusercontent.com/111494018/201639017-d06478dc-1889-41e1-8e1a-fc458c6eed22.png">

## d) Online. Tee uusi varasto GitHubiin (tai Gitlabiin tai mihin vain vastaavaan palveluun). Varaston nimessä ja lyhyessä kuvauksessa tulee olla sana "car" (auto). Aiemmin tehty varasto ei kelpaa. (Muista tehdä varastoon tiedostoja luomisvaiheessa, suosittelen tekemään README.md ja vapaista lisensseistä itse tykkään GPLv3 eli GNU General Public License, version 3) (Karvinen, 2022.)

## e) Dolly. Kloonaa edellisessä kohdassa tehty varasto itsellesi, tee muutoksia, puske ne palvelimelle, ja näytä, että ne ilmestyvät weppiliittymään. (Karvinen, 2022.)

## f) Vapaaehtoinen: Tee uusi salt-moduli. Voit asentaa ja konfiguroida minkä vain uuden ohjelman: demonin, työpöytäohjelman tai komentokehotteesta toimivan ohjelman. Käytä tarvittaessa ‘find -printf “%T+ %p\n”|sort’ löytääksesi uudet asetustiedostot. (Tietysti eri ohjelma kuin aiemmissa tehtävissä, tarkoitushan on harjoitella Salttia) (Karvinen, 2022.)

## g) Vapaaehtoinen: Laita salt gittiin. Tee uusi moduli. Kloonaa varastosi toiselle koneelle (tai poista srv/salt ja palauta se kloonaamalla) ja jatka sillä. (Salt tiedostot mistä vain hakemistosta, huomaa suhteellinen polku: 'sudo salt-call --local --file-root srv/salt/ state.apply') (Karvinen, 2022.)


### Lähteet:

T. Karvinen. H3 Git. Configuration Management - Palvelinnten hallinta. 
URL: https://terokarvinen.com/2022/palvelinten-hallinta-2022p2/?fromSearch=configuration%20management#h3-git
